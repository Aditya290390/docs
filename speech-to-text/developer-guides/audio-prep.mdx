---
title: 'Input and Preprocessing [TODO finalize]'
description: 'Optimize audio formats, sample rates, and preprocessing for Waves ASR'
---

# Input & preprocessing best practices

> Choose the right audio format, configure sample rates, and normalize audio before streaming to Waves ASR for optimal accuracy and latency.

This page consolidates the input/output guidance from the Waves ASR docs so you can prepare audio consistently across SDKs and Lightning ASR POST workflows.

## Sample rate selection

<CardGroup cols={2}>
  <Card title="16 kHz (recommended)" icon="microphone">
    Balanced quality and bandwidth for most speech-recognition workloads.
  </Card>
  <Card title="8 kHz" icon="phone">
    Telephony standard with the lowest network cost—ideal for PSTN or IVR audio.
  </Card>
  <Card title="44.1 kHz" icon="music">
    Use when transcripts must capture music-heavy or broadcast content.
  </Card>
  <Card title="48 kHz" icon="video">
    Maximum fidelity for professional video/multimedia pipelines (higher cost).
  </Card>
</CardGroup>

## Recommended configuration

```javascript title="Client configuration snippet"
const optimalConfig = {
  audioEncoding: "linear16",
  audioSampleRate: "16000",
  audioChannels: "1",
  addPunctuation: "true",
};
```

## Input format options

| Format   | Description       | Use case                  |
| -------- | ----------------- | ------------------------- |
| linear16 | 16-bit linear PCM | High accuracy, predictable bandwidth |
| flac     | FLAC compressed   | Archival/long recordings with lossless compression |
| mulaw    | μ-law encoded     | Telephony audio with minimal bandwidth |
| opus     | Opus compressed   | Browser-native streaming with variable bitrate |

<Tabs>
  <Tab title="linear16">
    **16-bit Linear PCM (recommended)**

    - Uncompressed and deterministic
    - Best accuracy/performance ratio
  </Tab>
  <Tab title="opus">
    **Opus compressed**

    - Lower bandwidth, great for browser/mobile
    - Slightly higher latency due to encoding
  </Tab>
  <Tab title="flac">
    **FLAC compressed**

    - Lossless compression for archival sets
    - Larger chunks, higher CPU load than Opus
  </Tab>
  <Tab title="mulaw">
    **μ-law encoded**

    - 8-bit telephony standard
    - Lowest fidelity but fits PSTN bandwidth limits
  </Tab>
</Tabs>

## Output response types

- **Partial results** – interim hypotheses while audio is mid-stream.
- **Final results** – confirmed transcription segments ready for storage.
- **End of turn** – indicates the model detected speech completion and flushed buffered text.

## Preprocessing checklist

- Normalize audio to roughly -3 dBFS to avoid clipping.
- Convert stereo inputs to mono to halve bandwidth.
- Trim leading/trailing silence or enable VAD to reduce billed seconds.
- Keep sample rate consistent with the value declared in your query parameters.

### Example preprocessing helper

```javascript title="preprocessing.js"
function preprocessAudio(audioBuffer) {
  const processed = new Float32Array(audioBuffer.length);
  const maxValue = Math.max(...audioBuffer.map(Math.abs));
  const normalization = maxValue > 0 ? 0.8 / maxValue : 1;

  for (let i = 0; i < audioBuffer.length; i++) {
    let sample = audioBuffer[i] * normalization;
    if (i > 0) {
      sample = sample - 0.95 * processed[i - 1];
    }
    processed[i] = sample;
  }
  return processed;
}
```

```javascript title="prepare-bytes.js"
function toPcm16Buffer(float32Array) {
  const int16 = new Int16Array(float32Array.length);
  for (let i = 0; i < float32Array.length; i++) {
    int16[i] = Math.max(-32768, Math.min(32767, float32Array[i] * 32768));
  }
  return Buffer.from(int16.buffer);
}
```

Apply preprocessing before converting to PCM16 (or while packing Opus frames) so the ASR engine receives consistent, normalized input—whether you write the bytes to disk or send them in the Lightning POST body.

